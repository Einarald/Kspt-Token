<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>KSPT Token</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<link rel="stylesheet" href="css/style.css">
</head>

<body>

<div id="toast" class="toast">Purchase successful</div>
<div id="whiteFade" class="white-fade"></div>

<div id="rewardPopup" class="reward-popup">
    <h2 style="color:#ff9800; margin-top:0;">REWARD!</h2>
    <img id="rewardImg" class="reward-img" src="" alt="Reward">
    <div id="rewardText" style="margin-bottom:20px; font-size:18px;"></div>
    <button onclick="closeReward()">Collect</button>
</div>

<div id="capsuleBreakModal" class="capsule-modal">
    <div id="capsuleHint" style="margin-bottom:20px; font-size:24px; font-weight:bold;">Tap to open!</div>
    <img id="capsuleBreakImg" src="capsule.png" class="capsule-center">
</div>

<div id="cheatWarningModal" class="warning-modal">
  <h2 style="color:red; font-size: 32px; margin-bottom: 10px;">STOP!</h2>
  <p style="font-size: 18px;">You are tapping too fast.</p>
  <p style="font-size: 14px; opacity: 0.7;">Continued fast tapping will reset your progress.</p>
  <button class="warning-btn-small" onclick="dismissWarning()">OK</button>
</div>

<div id="redScreen" class="red-screen">
  <h1>DONT CHEAT!!</h1>
  <div class="unban-group">
    <input type="text" id="unbanInput" placeholder="Enter Unban Key">
    <button onclick="attemptUnban()">Unlock</button>
  </div>
</div>

<script>
window.addEventListener('message', (event) => {
  const msg = event.data;
  if (!msg || typeof msg !== 'object') return;

  try {
    if (msg.type === 'kspt_award_reward') {
      // –≤—ã–∑—ã–≤–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é (–æ–Ω–∞ –µ—Å—Ç—å –≤ games.js)
      if (typeof awardGameReward === 'function') {
        awardGameReward(Number(msg.reward) || 0, msg.x || 0, msg.y || 0);
      }
    } else if (msg.type === 'kspt_consume_ticket') {
      if (typeof consumeTicketForCurrentGame === 'function') {
        consumeTicketForCurrentGame();
      }
    } else if (msg.type === 'kspt_exit_game') {
      if (typeof exitGame === 'function') exitGame();
    }
    else if (msg.type === 'ek_award') {
  if (typeof awardGameEK === 'function') {
    awardGameEK(Number(msg.amount) || 0, msg.x || 0, msg.y || 0);
  }
}
  } catch (e) {
    console.warn('message handler failed', e);
  }
});
</script>

<!-- Custom Keyboard -->
<div id="customKeyboard" class="custom-keyboard">
  <div class="keyboard-row">
    <button class="keyboard-key" data-key="1">1</button>
    <button class="keyboard-key" data-key="2">2</button>
    <button class="keyboard-key" data-key="3">3</button>
    <button class="keyboard-key" data-key="backspace">‚å´</button>
  </div>
  <div class="keyboard-row">
    <button class="keyboard-key" data-key="4">4</button>
    <button class="keyboard-key" data-key="5">5</button>
    <button class="keyboard-key" data-key="6">6</button>
    <button class="keyboard-key" data-key=".">.</button>
  </div>
  <div class="keyboard-row">
    <button class="keyboard-key" data-key="7">7</button>
    <button class="keyboard-key" data-key="8">8</button>
    <button class="keyboard-key" data-key="9">9</button>
    <button class="keyboard-key" data-key="0">0</button>
  </div>
  <div class="keyboard-row">
    <button class="keyboard-key wide" data-key="done">DONE</button>
  </div>
</div>

<!-- Image Cropping Modal -->
<div id="cropModal" class="crop-modal">
  <div style="color: white; font-size: 20px; margin-bottom: 20px;">Crop Your Image</div>
  <div class="crop-container">
    <img id="cropImage" class="crop-image" src="" alt="Crop Image">
    <div class="crop-circle"></div>
  </div>
  <div class="crop-zoom">
    <span>Zoom:</span>
    <input id="cropZoom" type="range" min="25" max="400" value="100">
  </div>
  <div class="crop-controls">
    <button onclick="cancelCrop()" style="background: #d32f2f;">Cancel</button>
    <button onclick="applyCrop()" style="background: #2e7d32;">Apply Crop</button>
  </div>
</div>

<div class="app">

<div id="main" class="screen active">
  <!-- REMOVED LANGUAGE SELECTOR FROM MAIN SCREEN -->
  <div class="balance-main" id="balanceMain">0.00 KSPT</div>
  <div class="offline-info" id="offlineRateMain">Offline: 0.00 KSPT/h</div>

  <div class="coin-3d-container" id="coin3dContainer">
  <div class="coin-3d" id="coin3d">
    <img id="coin" class="coin" src="kspt.png" alt="Coin">
  </div>
</div>
  
  <div class="energy-box">
    <img src="ener.png" alt="E">
    <span id="energyDisplay">2500 / 2500</span>
  </div>
  
  <div class="bottom-bar">
    <div class="button-row">
      <div class="long-btn" onclick="openScreen('skins')">
        <img src="m.png" alt="Skins">
      </div>
      <div class="long-btn" onclick="openScreen('offlineShop')">
        <img src="k.png" alt="Mining">
      </div>
    </div>
    <div class="button-row">
      <div class="long-btn" onclick="openScreen('tech')">
         <img src="t.png" alt="Tech">
      </div>
      <div class="long-btn" onclick="openScreen('capsuleScreen')">
         <img src="puz.png" alt="Capsule">
      </div>
    </div>
    <div class="settings-row">
       <div class="settings-btn" onclick="openScreen('settings')">
          <img src="settings.png" alt="Settings">
       </div>
    </div>
  </div>
</div>

<div id="market" class="screen">
  <div id="marketContainer"></div>
</div>

<div id="games" class="screen">
  <div class="top-bar">
  <!-- –ø–æ–∫–∞–∑—ã–≤–∞–µ–º EK-–∏–∫–æ–Ω–∫—É –≤ Games (fallback –Ω–∞ kspt –µ—Å–ª–∏ –Ω–µ—Ç ek.png) -->
  <img id="gamesCurrencyIcon" src="ek.png" onerror="this.src='kspt.png'">
  <span id="balanceGames"></span>
  <img src="iks.png" class="close-x" onclick="openScreen('main')">
</div>

        <div class="card" id="ekShopCard" style="cursor:pointer;">
    <div class="card-title" style="color: #ffb300;">
      üõí EK Shop
    </div>
    <div class="card-sub" style="color: #ffe0b2;">
      Open the EK Shop to buy skins & backgrounds
    </div>
  </div>

  <!-- –ë–∏–ª–µ—Ç—ã -->
  <div class="card" style="background: linear-gradient(135deg, #1a237e, #311b92);">
    <div class="card-title" style="color: #18ffff;">
      <span data-lang-key="tickets_label">üé´ Tickets:</span>
      <span id="ticketCount">10</span>/10
    </div>
    <div class="card-sub" style="color: #b388ff;" data-lang-key="tickets_left_today">You have <span id="ticketsLeft">10</span> tickets left today</div>
    <div id="ticketTimer" class="card-sub" style="color: #ff4081; display: none;">
      <span data-lang-key="next_ticket_in">Next ticket in:</span> <span id="ticketTimerText">23:59:59</span>
    </div>
  </div>

    <!-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä -->
  <div class="card">
    <div class="card-title" style="color: #00e676;">Available Games</div>
    <div class="card-sub" style="color: #b9f6ca;">1 ticket = 1 game session</div>

    <!-- Snake Game -->
    <div class="game-item" onclick="startGame('snake')">
      <img src="snake.png" class="game-icon">
      <div class="game-info">
        <div class="game-title">Snake Game</div>
        <div class="game-desc">Eat apples, grow longer, earn KSPT!</div>
      </div>
      <div class="game-ticket">1 ticket</div>
    </div>

    <!-- Ping-Pong -->
    <div class="game-item" onclick="startGame('pingpong')">
      <img src="pong.png" class="game-icon">
      <div class="game-info">
        <div class="game-title">Ping-Pong</div>
        <div class="game-desc">Defend your goal, score points, earn KSPT!</div>
      </div>
      <div class="game-ticket">1 ticket</div>
    </div>

    <!-- BlocksFast -->
    <div class="game-item" onclick="startGame('blocksfast')">
      <img src="tetris.png" class="game-icon" alt="BlocksFast">
      <div class="game-info">
        <div class="game-title">BlocksFast</div>
        <div class="game-desc">Fast block-matching ‚Äî like BlockBlast. Clear lines, chain combos, earn KSPT!</div>
      </div>
      <div class="game-ticket">1 ticket</div>
    </div>

    <!-- Slither: KSPT Mode -->
    <div class="game-item" onclick="startGame('slither')">
      <img src="slither.png" class="game-icon" alt="Slither">
      <div class="game-info">
        <div class="game-title">Slither: KSPT Mode</div>
        <div class="game-desc">Classic slither.io-style ‚Äî grow by eating orbs, avoid others, earn KSPT!</div>
      </div>
      <div class="game-ticket">1 ticket</div>
    </div>

  </div>

    <button class="back" onclick="openScreen('main')" data-lang-key="back">Back</button>
  </div>

<!-- –ò–≥—Ä–æ–≤—ã–µ —ç–∫—Ä–∞–Ω—ã (–±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ iframe) -->
<div id="gameContainer" class="screen" style="display:none;">
  <div class="top-bar">
    <img src="kspt.png">
    <span id="balanceGame"></span>
    <img src="iks.png" class="close-x" onclick="exitGame()">
  </div>
  <div id="gameFrameContainer"></div>
</div>

<div id="capsuleScreen" class="screen">
  <div class="top-bar">
    <img src="kspt.png">
    <span id="balanceCapsule"></span>
    <img src="iks.png" class="close-x" onclick="openScreen('main')">
  </div>

  <!-- –ö–ù–û–ü–ö–ò –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–Ø –í–ö–õ–ê–î–û–ö -->
  <div style="display: flex; justify-content: center; margin-bottom: 15px;">
    <button id="tabPuzzle" onclick="showIventTab('puzzle')" style="margin-right: 10px; background: #2e7d32;">–ü–∞–∑–ª—ã</button>
    <button id="tabIvent" onclick="showIventTab('ivent')" style="background: #444;">–°–æ–±—ã—Ç–∏—è</button>
  </div>

  <!-- –í–ö–õ–ê–î–ö–ê –ü–ê–ó–õ–û–í (–ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ) -->
  <div id="puzzleTab">
    <div class="card">
      <div class="card-title" data-lang-key="ancient_puzzle">Ancient Puzzle</div>
      <div class="card-sub" data-lang-key="puzzle_desc">Collect all 9 pieces to unlock Hamster Piece Skin!</div>
      
      <div class="puzzle-container">
          <div class="puzzle-grid">
             <img src="pazl.png" id="puzzleFull" class="puzzle-full-img">
             <div class="puzzle-cell" id="pz1"><img src="pazl1.png"></div>
              <div class="puzzle-cell" id="pz2"><img src="pazl2.png"></div>
              <div class="puzzle-cell" id="pz3"><img src="pazl3.png"></div>
              <div class="puzzle-cell" id="pz4"><img src="pazl4.png"></div>
              <div class="puzzle-cell" id="pz5"><img src="pazl5.png"></div>
              <div class="puzzle-cell" id="pz6"><img src="pazl6.png"></div>
              <div class="puzzle-cell" id="pz7"><img src="pazl7.png"></div>
              <div class="puzzle-cell" id="pz8"><img src="pazl8.png"></div>
              <div class="puzzle-cell" id="pz9"><img src="pazl9.png"></div>
          </div>
          <div class="puzzle-controls">
              <div id="puzzleStatus" class="card-sub" style="margin-bottom:10px;" data-lang-key="owned">Owned: 0/9</div>
              <button id="btnPlacePiece" onclick="placePuzzlePieces()" style="display:none;" data-lang-key="place_pieces">Place Available Pieces</button>
               <div id="puzzleCompletedText" style="display:none; color:#ff9800; font-weight:bold; margin-top:10px;" data-lang-key="puzzle_completed">A new puzzle will appear soon!</div>
          </div>
      </div>
    </div>

    <!-- –í—Ç–æ—Ä–æ–π (–∫–æ—à–∞—á–∏–π) –ø–∞–∑–ª: —Å–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é -->
    <div class="card" id="secondPuzzleCard" style="display:none;">
      <div class="card-title" data-lang-key="cat_puzzle">Cat Puzzle</div>
      <div class="card-sub" data-lang-key="cat_puzzle_desc">
        Collect all 9 pieces to unlock the Cat: KSPT skin!
      </div>
      <div class="puzzle-container">
        <div class="puzzle-grid">
          <img src="pazlik.png" id="puzzleFull2" class="puzzle-full-img" style="display:none;">
          <!-- —á–∞—Å—Ç–∏ –ø–∞–∑–ª–∞ 11‚Äì19 -->
          <div class="puzzle-cell" id="pz2_1"><img src="pazl11.png" onerror="this.src='dontwhat.png'"></div>
          <div class="puzzle-cell" id="pz2_2"><img src="pazl12.png" onerror="this.src='dontwhat.png'"></div>
          <div class="puzzle-cell" id="pz2_3"><img src="pazl13.png" onerror="this.src='dontwhat.png'"></div>
          <div class="puzzle-cell" id="pz2_4"><img src="pazl14.png" onerror="this.src='dontwhat.png'"></div>
          <div class="puzzle-cell" id="pz2_5"><img src="pazl15.png" onerror="this.src='dontwhat.png'"></div>
          <div class="puzzle-cell" id="pz2_6"><img src="pazl16.png" onerror="this.src='dontwhat.png'"></div>
          <div class="puzzle-cell" id="pz2_7"><img src="pazl17.png" onerror="this.src='dontwhat.png'"></div>
          <div class="puzzle-cell" id="pz2_8"><img src="pazl18.png" onerror="this.src='dontwhat.png'"></div>
          <div class="puzzle-cell" id="pz2_9"><img src="pazl19.png" onerror="this.src='dontwhat.png'"></div>
        </div>
        <div class="puzzle-controls">
          <div id="puzzleStatus2" class="card-sub" style="margin-bottom:10px;"
               data-lang-key="owned_progress">Owned: 0/9</div>
          <button id="btnPlacePiece2" onclick="placePuzzlePieces2()"
                  style="display:none;" data-lang-key="place_pieces">
            Place Available Pieces
          </button>
          <div id="puzzleCompletedText2"
               style="display:none; color:#ff9800; font-weight:bold; margin-top:10px;"
               data-lang-key="puzzle_completed2">
            More puzzles coming soon!
          </div>
        </div>
      </div>
    </div>

    <div class="card capsule-info">
      <img src="capsule.png" class="capsule-img-small">
      <div class="card-title" data-lang-key="mystery_capsule">Mystery Capsule</div>
      <div class="card-sub" id="capsuleTimer" data-lang-key="ready">Ready to open!</div>
      <button id="btnOpenCapsule" onclick="startCapsuleSequence()" style="background:#ff9800; color:#000; font-weight:bold; margin-top:10px;" data-lang-key="open">OPEN!</button>
    </div>
  </div>

  <!-- –í–ö–õ–ê–î–ö–ê –°–û–ë–´–¢–ò–ô (–°–ö–†–´–¢–ê –ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ) -->
  <div id="iventTab" style="display:none;">
    <!-- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è -->
    <div class="card">
      <div class="card-title" data-lang-key="ivent_title">–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è</div>
      <div class="card-sub" data-lang-key="ivent_desc">–£—Å–ø–µ–π –ø–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—ã!</div>
      
      <div id="iventContainer">
        <!-- –°—é–¥–∞ –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª—è—Ç—å—Å—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–æ–±—ã—Ç–∏—è -->
      </div>
    </div>
  </div>

  <button class="back" onclick="openScreen('main')" data-lang-key="back">Back</button>
</div>

<div id="settings" class="screen">
  <div class="top-bar">
    <img src="kspt.png">
    <span id="balanceSettings"></span>
    <img src="iks.png" class="close-x" onclick="openScreen('main')">
  </div>

  <div id="settings-main">
    <div class="settings-section">
      <div class="card-title" data-lang-key="settings">Settings</div>
      <div class="card-sub" data-lang-key="choose_category">Choose a category</div>
      <button onclick="showSettingsSub('sound')" style="margin-bottom:12px;" data-lang-key="vibration_sound">Vibration & Sound</button>
      <button onclick="showSettingsSub('animation')" style="margin-bottom:12px;" data-lang-key="animation">Animation</button>
      <button onclick="showSettingsSub('bg')" style="margin-bottom:12px;" data-lang-key="backgrounds">Backgrounds</button>
      <button onclick="showSettingsSub('language')" data-lang-key="language">Language</button>
    </div>
    <button class="back" onclick="openScreen('main')" data-lang-key="back">Back</button>
  </div>

  <div id="settings-animation" style="display:none;">
    <div class="settings-section">
      <div class="card-title" data-lang-key="animation_settings">Animation Settings</div>
      <div class="card-sub" data-lang-key="control_animation">Control animation effects</div>
      
      <div class="settings-checkbox">
        <div style="flex:1;">
          <label for="toggleSkinsAnim" data-lang-key="skins_animation">Skins animation</label>
          <div class="subtext" data-lang-key="skins_animation_desc">Default: ON - Controls skin tap/cycle animations</div>
        </div>
        <label class="toggle-switch">
          <input type="checkbox" id="toggleSkinsAnim" checked onchange="toggleAnimationSetting('skins', this.checked)">
          <span class="toggle-slider"></span>
        </label>
      </div>
      
      <div class="settings-checkbox">
        <div style="flex:1;">
          <label for="toggleTransitions" data-lang-key="ui_transitions">UI transition animation</label>
          <div class="subtext" data-lang-key="ui_transitions_desc">Default: ON - Controls smooth page transitions</div>
        </div>
        <label class="toggle-switch">
          <input type="checkbox" id="toggleTransitions" checked onchange="toggleAnimationSetting('transitions', this.checked)">
          <span class="toggle-slider"></span>
        </label>
      </div>

<div class="settings-checkbox">
  <div style="flex:1;">
    <label for="toggle3DEffect" data-lang-key="3d_effect">3D Coin Effect</label>
    <div class="subtext" data-lang-key="3d_effect_desc">Tilt the coin with mouse/finger</div>
  </div>
  <label class="toggle-switch">
    <input type="checkbox" id="toggle3DEffect" checked onchange="toggle3DEffect(this.checked)">
    <span class="toggle-slider"></span>
  </label>
</div>
    </div>
    <button class="back" onclick="showSettingsSub('main')" data-lang-key="back">Back</button>
  </div>

  <div id="settings-language" style="display:none;">
    <div class="settings-section">
      <div class="card-title" data-lang-key="language_settings">Language Settings</div>
      <div class="card-sub" data-lang-key="choose_language">Choose your preferred language</div>
      
      <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 15px;">
        <button onclick="setLanguage('en')" style="text-align: left; padding: 12px; background: #262626; border-radius: 8px; border: none; color: white; cursor: pointer;">
          <div style="font-weight: bold;">English</div>
          <div style="font-size: 12px; opacity: 0.7;" data-lang-key="english_desc">Default language</div>
        </button>
        
        <button onclick="setLanguage('ru')" style="text-align: left; padding: 12px; background: #262626; border-radius: 8px; border: none; color: white; cursor: pointer;">
          <div style="font-weight: bold;">–†—É—Å—Å–∫–∏–π</div>
          <div style="font-size: 12px; opacity: 0.7;" data-lang-key="russian_desc">Russian language</div>
        </button>
      </div>
    </div>
    <button class="back" onclick="showSettingsSub('main')" data-lang-key="back">Back</button>
  </div>

  <div id="settings-sound" style="display:none;">
    <div class="settings-section">
        <div class="card-title" data-lang-key="vibration">Vibration</div>
        <div class="card-sub" data-lang-key="haptic_feedback">Haptic Feedback</div>
        <div class="button-row">
            <button id="vib-off" onclick="setVibration('off')" style="width:23%; padding:8px; font-size:12px;" data-lang-key="off">Off</button>
            <button id="vib-low" onclick="setVibration('low')" style="width:23%; padding:8px; font-size:12px;" data-lang-key="low">Low</button>
            <button id="vib-med" onclick="setVibration('medium')" style="width:23%; padding:8px; font-size:12px;" data-lang-key="medium">Med</button>
            <button id="vib-str" onclick="setVibration('strong')" style="width:23%; padding:8px; font-size:12px;" data-lang-key="strong">Strong</button>
        </div>

        <div class="settings-checkbox" style="margin-top:15px;">
          <div style="flex:1;">
            <label for="toggleTapVib" data-lang-key="tap_vibration">Tap vibration</label>
            <div class="subtext" data-lang-key="tap_vibration_desc">Default: ON - Vibration for coin taps</div>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="toggleTapVib" checked onchange="toggleVibrationSetting('tapsEnabled', this.checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>
        
        <div class="settings-checkbox">
          <div style="flex:1;">
            <label for="toggleButtonVib" data-lang-key="button_vibration">Other buttons vibration</label>
            <div class="subtext" data-lang-key="button_vibration_desc">Default: ON - Vibration for UI buttons</div>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="toggleButtonVib" checked onchange="toggleVibrationSetting('buttonsEnabled', this.checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>
    </div>

    <div class="settings-section">
        <div class="card-title" data-lang-key="music">Music</div>
        <div class="card-sub" data-lang-key="game_soundtrack">Game Soundtrack</div>
        <button id="music-stop" onclick="stopMusic()" style="margin-bottom:10px; background:#444;" data-lang-key="disable_music">Disable Music</button>
        
        <!-- –ë–ª–æ–∫ –¥–ª—è Mystic Wild West -->
<div style="display:flex; align-items:center; gap:10px; margin-bottom:10px; border-top:1px solid #333; padding-top:10px;">
    <img src="mistic.png" style="width:30px; height:30px; border-radius:5px;">
    <div style="flex:1;">
        <div style="font-weight:bold; font-size:14px;">Mystic Wild West</div>
        <div style="font-size:11px; opacity:0.6;" data-lang-key="default">Default</div>
    </div>
    <button onclick="previewMusic('mistic')" style="width:auto; padding:5px 10px; font-size:11px; margin-right:5px;" data-lang-key="preview">Play 15s</button>
    <button id="btn-music-mistic" style="width:auto; padding:5px 10px; font-size:11px;">Select</button>
</div>

<!-- –ë–ª–æ–∫ –¥–ª—è Victory Europop -->
<div style="display:flex; align-items:center; gap:10px; margin-bottom:10px; border-top:1px solid #333; padding-top:10px;">
  <img src="gabber.png" style="width:30px; height:30px; border-radius:5px;">
  <div style="flex:1;">
    <div style="font-weight:bold; font-size:14px;">Victory Europop</div>
    <div style="font-size:11px; opacity:0.6;" data-lang-key="price">Price: 210 KSPT</div>
  </div>
  <button onclick="previewMusic('gabber')" style="width:auto; padding:5px 10px; font-size:11px; margin-right:5px;" data-lang-key="preview">Play 15s</button>
  <button id="btn-music-gabber" onclick="buyMusic('gabber', 210)" style="width:auto; padding:5px 10px; font-size:11px;" data-lang-key="buy">Buy</button>
</div>

<div id="music-onion-row" style="display:flex; align-items:center; gap:10px; margin-bottom:10px; border-top:1px solid #333; padding-top:10px; display:none;">
  <img src="onion.png" style="width:30px; height:30px; border-radius:5px;">
   <div style="flex:1;">
    <div style="font-weight:bold; font-size:14px;">Funny Onion Song</div>
    <div style="font-size:11px; opacity:0.6;" data-lang-key="exclusive">Exclusive</div>
  </div>
   <button onclick="previewMusic('onion')" style="width:auto; padding:5px 10px; font-size:11px; margin-right:5px;" data-lang-key="preview">Play 15s</button>
  <button id="btn-music-onion" onclick="setMusic('onion')" style="width:auto; padding:5px 10px; font-size:11px;" data-lang-key="select">Select</button>
</div>

<div style="display:flex; align-items:center; gap:10px; margin-bottom:10px; border-top:1px solid #333; padding-top:10px;">
  <img src="calm.png" style="width:30px; height:30px; border-radius:5px;">
   <div style="flex:1;">
    <div style="font-weight:bold; font-size:14px;">Calm + Hush</div>
    <div style="font-size:11px; opacity:0.6;" data-lang-key="capsule_exclusive">Capsule Exclusive</div>
  </div>
   <button onclick="previewMusic('calm')" style="width:auto; padding:5px 10px; font-size:11px; margin-right:5px;" data-lang-key="preview">Play 15s</button>
  <button id="btn-music-calm" onclick="setMusic('calm')" style="width:auto; padding:5px 10px; font-size:11px;" data-lang-key="locked">Locked</button>
</div>

<div style="display:flex; align-items:center; gap:10px; margin-bottom:10px; border-top:1px solid #333; padding-top:10px;">
  <img src="siulaisong.png" style="width:30px; height:30px; border-radius:5px;">
  <div style="flex:1;">
    <div style="font-weight:bold; font-size:14px;">Cat's Yarn</div>
    <div style="font-size:11px; opacity:0.6;" data-lang-key="locked">Locked</div>
  </div>
  <button onclick="previewMusic('siulai')" style="width:auto; padding:5px 10px; font-size:11px; margin-right:5px;"
          data-lang-key="preview">Play 15s</button>
  <button id="btn-music-siulai" onclick="setMusic('siulai')"
          style="width:auto; padding:5px 10px; font-size:11px;"
          data-lang-key="select">Select</button>
</div>

<!-- –ë–ª–æ–∫ –¥–ª—è LOL Song (—Ç–µ–ø–µ—Ä—å —Å–∞–º—ã–π –ø–æ—Å–ª–µ–¥–Ω–∏–π) -->
<div style="display:flex; align-items:center; gap:10px; margin-bottom:10px; border-top:1px solid #333; padding-top:10px;">
  <img src="funny.png" style="width:30px; height:30px; border-radius:5px;">
  <div style="flex:1;">
    <div style="font-weight:bold; font-size:14px;" data-lang-key="lol_song">LOL Song</div>
    <div style="font-size:11px; opacity:0.6;" data-lang-key="capsule_exclusive">Capsule Exclusive</div>
  </div>
  <button onclick="previewMusic('funny')" style="width:auto; padding:5px 10px; font-size:11px; margin-right:5px;" data-lang-key="preview">Play 15s</button>
  <button id="btn-music-funny" class="owned" style="width:auto; padding:5px 10px; font-size:11px;">Locked</button>
</div>
    </div>
    <button class="back" onclick="showSettingsSub('main')" data-lang-key="back">Back</button>
  </div>

  <div id="settings-bg" style="display:none;">
      <div class="settings-section">
        <div class="card-title" data-lang-key="backgrounds">Backgrounds</div>
        <div class="card-sub" data-lang-key="customize_menu">Customize your main menu</div>
      </div>

      <div class="settings-section">
        <div class="bg-preview" style="background-color: #0b0b0b;"></div>
        <div class="card-title" data-lang-key="default_dark">Default Dark</div>
        <div class="card-sub" data-lang-key="classic_style">Classic KSPT style</div>
        <button id="bg-btn-default" onclick="equipBackground('default')" data-lang-key="selected">Selected</button>
      </div>

      <div class="settings-section">
        <div class="bg-preview" style="background-image: url('forest.png');"></div>
        <div class="card-title" data-lang-key="forest_vibe">Forest Vibe</div>
        <div class="card-sub" data-lang-key="nature_look">Nature look</div>
        <button id="bg-btn-forest" onclick="buyBackground('forest', 320)" data-lang-key="buy">Buy 320 KSPT</button>
      </div>

      <div class="settings-section">
        <div class="bg-preview" style="background-image: url('star.png');"></div>
        <div class="card-title" data-lang-key="space_view">Space View</div>
        <div class="card-sub" data-lang-key="space_skin">Included in Space Edition Skin</div>
        <button id="bg-btn-space" onclick="equipBackground('space')" data-lang-key="locked_buy">Locked (Buy Space Skin)</button>
      </div>

      <div class="settings-section">
        <div class="bg-preview" style="background-image: url('heaven.png');"></div>
        <div class="card-title" data-lang-key="heaven">Heaven</div>
        <div class="card-sub" data-lang-key="capsule_drop">Rare Capsule Drop</div>
        <button id="bg-btn-heaven" onclick="equipBackground('heaven')" data-lang-key="locked">Locked</button>
      </div>

      <div class="settings-section">
        <div class="bg-preview" style="background-image: url('ric.png'); border: 2px solid gold;"></div>
        <div class="card-title" style="color: gold;" data-lang-key="rich_edition">KSPT: Rich Edition</div>
        <div class="card-sub" data-lang-key="for_elite">For the elite</div>
        <button id="bg-btn-ric" onclick="buyBackground('ric', 5120)" data-lang-key="buy">Buy 5120 KSPT</button>
      </div>
      
      <div class="settings-section">
        <div class="bg-preview" style="background-image: url('bug.png');"></div>
        <div class="card-title" data-lang-key="dead_pixel">Dead Pixel</div>
        <div class="card-sub" data-lang-key="pixel_bonus">Bonus with Pixel Coin Skin</div>
       <button id="bg-btn-bug" onclick="equipBackground('bug')" data-lang-key="locked">Locked</button>
      </div>
      
      <div class="settings-section">
        <div class="bg-preview" style="background-image: url('chrisp.png');"></div>
        <div class="card-title" data-lang-key="chrispy_candle">Chrispy Candle</div>
        <div class="card-sub" data-lang-key="chrispy_desc">The crispiest cookies in the world.</div>
       <button id="bg-btn-chrisp" onclick="equipBackground('chrisp')" data-lang-key="locked_buy">Locked (Buy Crypto Cookie Skin)</button>
      </div>
      
      <!-- NEW: Bandit X Fone background -->
      <div class="settings-section">
        <div class="bg-preview" style="background-image: url('xfone.png');"></div>
        <div class="card-title">Bandit X Fone</div>
        <div class="card-sub">Unlocks after buying Bandit X skin</div>
        <button id="bg-btn-xfone" onclick="equipBackground('xfone')">Locked</button>
      </div>

<!-- –≤—Å—Ç–∞–≤–∏—Ç—å —Ä—è–¥–æ–º —Å –¥—Ä—É–≥–∏–º–∏ bg-–∫–Ω–æ–ø–∫–∞–º–∏ -->
<div class="settings-section">
  <div class="bg-preview" style="background-image: url('hell.png');"></div>
  <div class="card-title">Hell</div>
  <div class="card-sub">Exclusive: Secret Gold Capsule only</div>
  <button id="bg-btn-hell" style="background:#333; opacity:0.6; color:#fff;">Locked</button>
</div>

<div class="settings-section">
  <div class="bg-preview" style="background-image: url('math.png');"></div>
  <div class="card-title">Crazy Math</div>
  <div class="card-sub">Exclusive: Secret Gold Capsule only</div>
  <button id="bg-btn-math" style="background:#333; opacity:0.6; color:#fff;">Locked</button>
</div>
      
      <button class="back" onclick="showSettingsSub('main')" data-lang-key="back">Back</button>
  </div>
</div>

<div id="skins" class="screen">
  <div class="top-bar">
    <img src="kspt.png">
    <span id="balanceSkins"></span>
    <img src="iks.png" class="close-x" onclick="openScreen('main')">
  </div>

  <!-- Updated skin cards with dynamic text rendering -->
  <div class="card">
    <img id="skin-img-default" src="dontwhat.png" class="card-img">
    <div class="card-title" data-lang-key="default_coin">Default Coin</div>
    <div id="skin-sub-default" class="card-sub">Standard (+0 KSPT/h)</div>
    <button id="skin-default" onclick="applySkin('default')" data-lang-key="select">Select</button>
  </div>

  <div class="card">
    <img id="skin-img-what" src="dontwhat.png" class="card-img">
    <div class="card-title">WHAT IS KSPT</div>
    <div id="skin-sub-what" class="card-sub"></div>
  <button id="skin-what" onclick="buySkin('what',1)" data-lang-key="buy">BUY 1 KSPT</button>
  </div>

  <div class="card">
    <img id="skin-img-burger" src="dontwhat.png" class="card-img">
    <div class="card-title">KSPT Burger Edition</div>
    <div id="skin-sub-burger" class="card-sub"></div>
    <button id="skin-burger" onclick="buySkin('burger',10)" data-lang-key="buy">BUY 10 KSPT</button>
  </div>

  <div class="card">
    <img id="skin-img-joost" src="dontwhat.png" class="card-img">
    <div class="card-title">Little Aqua</div>
    <div id="skin-sub-joost" class="card-sub"></div>
    <button id="skin-joost" onclick="buySkin('joost',30)" data-lang-key="buy">BUY 30 KSPT</button>
  </div>

  <div class="card">
    <img id="skin-img-dog" src="dontwhat.png" class="card-img">
    <div class="card-title">Dogs World</div>
    <div id="skin-sub-dog" class="card-sub"></div>
    <button id="skin-dog" onclick="buySkin('dog',80)" data-lang-key="buy">BUY 80 KSPT</button>
  </div>

  <div class="card">
    <img id="skin-img-diam" src="dontwhat.png" class="card-img">
    <div class="card-title">Cringe Diamond</div>
    <div id="skin-sub-diam" class="card-sub"></div>
    <button id="skin-diam" onclick="buySkin('diam',100)" data-lang-key="buy">BUY 100 KSPT</button>
  </div>
  
  <div class="card">
    <img id="skin-img-tung" src="dontwhat.png" class="card-img">
    <div class="card-title">Meme-Brain</div>
    <div class="card-sub" data-lang-key="skin_animation">Skin + animation</div> <div id="skin-sub-tung" class="card-sub"></div>
    <button id="skin-tung" onclick="buySkin('tung',240)" data-lang-key="buy">BUY 240 KSPT</button>
  </div>

  <div class="card">
    <img id="skin-img-euro" src="dontwhat.png" class="card-img">
    <div class="card-title">Euro Coin</div>
    <div class="card-sub" data-lang-key="additional_skin">Skin + additional skin</div>
    <div id="skin-sub-euro" class="card-sub"></div>
    <div style="display: flex; gap: 5px; margin-top: 10px;">
      <button id="skin-euro" onclick="buySkin('euro',780)" data-lang-key="buy" style="flex: 1;">BUY 780 KSPT</button>
      <button id="variant-euro" onclick="switchVariant('euro')" style="display:none; background: #444; width: auto; padding: 0 10px;">Variant</button>
    </div>
  </div>

  <div class="card">
    <img id="skin-img-space" src="dontwhat.png" class="card-img">
    <div class="card-title">KSPT: Space Edition</div>
    <div class="card-sub" data-lang-key="skin_bg_animation">Skin + animation + background</div>
    <div id="skin-sub-space" class="card-sub"></div> 
    <button id="skin-space" onclick="buySkin('space',1210)" data-lang-key="buy">BUY 1210 KSPT</button>
  </div>
  
  <div class="card">
    <img id="skin-img-pixe" src="dontwhat.png" class="card-img">
    <div class="card-title">Pixel Coin</div>
    <div class="card-sub" data-lang-key="toggle_animation">Toggle animation + visual style</div>
    <div id="skin-sub-pixe" class="card-sub"></div>
    <button id="skin-pixe" onclick="buySkin('pixe',3215)" data-lang-key="buy">BUY 3,215 KSPT</button>
  </div>

  <div class="card">
    <img id="skin-img-onion" src="dontwhat.png" class="card-img">
    <div class="card-title">Funny Onion</div>
    <div class="card-sub" data-lang-key="expensive_skin">Most expensive skin + animation</div>
    <div id="skin-sub-onion" class="card-sub"></div>
    <button id="skin-onion" onclick="buySkin('onion',10110)" data-lang-key="buy">BUY 10,110 KSPT</button>
  </div>

  <div class="card">
    <img id="skin-img-cookie" src="dontwhat.png" class="card-img">
    <div class="card-title">Crypto Cookie</div>
    <div id="skin-sub-cookie" class="card-sub"></div>
    <button id="skin-cookie" onclick="buySkin('cookie',40780)" data-lang-key="buy">BUY 40,780 KSPT</button>
  </div>

  <!-- NEW SKINS ADDED HERE -->
  <div class="card">
    <img id="skin-img-ruka" src="dontwhat.png" class="card-img">
    <div class="card-title">Scary Palm</div>
    <div id="skin-sub-ruka" class="card-sub">Clench it into a fist!</div>
    <button id="skin-ruka" onclick="buySkin('ruka',172080)" data-lang-key="buy">BUY 172,080 KSPT</button>
  </div>

  <div class="card">
    <img id="skin-img-banditx" src="dontwhat.png" class="card-img">
    <div class="card-title">BANX: Bandit X</div>
    <div id="skin-sub-banditx" class="card-sub">Scary Bandit + Animation + Fone</div>
    <button id="skin-banditx" onclick="buySkin('banditx',542123)" data-lang-key="buy">BUY 542,123 KSPT</button>
  </div>

  <div class="card">
    <img id="skin-img-goldcoin" src="dontwhat.png" class="card-img">
    <div class="card-title">Default Gold Coin</div>
    <div id="skin-sub-goldcoin" class="card-sub">the MOST EXSPENSIVE coin in the KSPT.</div>
    <button id="skin-goldcoin" onclick="buySkin('goldcoin',1120000)" data-lang-key="buy">BUY 1,120,000 KSPT</button>
  </div>

<div class="card" id="skinCardGkspt" style="display:none">
  <img id="skin-img-gkspt" src="knowdont.png" class="card-img">
  <div class="card-title" data-lang-key="gold_kspt">Gold KSPT</div>
  <div id="skin-sub-gkspt" class="card-sub" data-lang-key="capsule_exclusive">Capsule Exclusive (+10 KSPT/h)</div>
  <button id="skin-gkspt" onclick="applySkin('gkspt')" data-lang-key="locked">LOCKED</button>
</div>

<div class="card" id="skinCardCyberAndroid" style="display:none">
  <img id="skin-img-cyber_android" src="knowdont.png" class="card-img">
  <div class="card-title" data-lang-key="cyber_android">KSPT: Cyber Android</div>
  <div id="skin-sub-cyber_android" class="card-sub" data-lang-key="capsule_exclusive">Capsule Exclusive (+15 KSPT/h)</div>
  <button id="skin-cyber_android" onclick="applySkin('cyber_android')" data-lang-key="locked">LOCKED</button>
</div>

<div class="card" id="skinCardDirty" style="display:none">
  <img id="skin-img-dirty" src="knowdont.png" class="card-img">
  <div class="card-title">Dirty Fingers</div>
  <div class="card-sub">Noob Box Exclusive (+10 KSPT/h)</div>
  <button id="skin-dirty" onclick="applySkin('dirty')" data-lang-key="select">Select</button>
</div>

<div class="card" id="skinCardSiulai" style="display:none">
  <img id="skin-img-siulai" src="knowdont.png" class="card-img">
  <div class="card-title">Cat: KSPT</div>
  <div class="card-sub">Cat Puzzle Reward (+20 KSPT/h)</div>
  <button id="skin-siulai" onclick="applySkin('siulai')" data-lang-key="select">Select</button>
</div>

<div class="card" id="skinCardCryptoHeart" style="display:none">
  <img id="skin-img-crypto_heart" src="knowdont.png" class="card-img">
  <div class="card-title">Crypto-heart</div>
  <div class="card-sub">Valentine's Day Exclusive (+14 KSPT/h)</div>
  <button id="skin-crypto_heart" onclick="applySkin('crypto_heart')" data-lang-key="locked">LOCKED</button>
</div>

  <div class="card" id="skinCardMystic" style="display:none">
   <img id="skin-img-mystic" src="knowdont.png" class="card-img">
   <div class="card-title">Hamster Piece</div>
    <div class="card-sub" data-lang-key="price_income">Puzzle Reward (+15 KSPT/h)</div>
    <button id="skin-mystic" onclick="applySkin('mystic')" data-lang-key="locked_complete">LOCKED (Complete Puzzle)</button>
  </div>

    <div class="card" id="skinCardCapsule" style="display:none">
    <img id="skin-img-capsule" src="knowdont.png" class="card-img">
    <div class="card-title">Capsule Master</div>
    <div class="card-sub" data-lang-key="price_income">Ultra Rare Capsule Drop (+10 KSPT/h)</div>
    <button id="skin-capsule" onclick="applySkin('capsule')" data-lang-key="locked_find">LOCKED (Find in Capsule)</button>
  </div>

  <div class="card" id="kostiaSkinCard" style="display:none">
    <img id="skin-img-kostia" src="knowdont.png" class="card-img">
    <div class="card-title">KSPT: Community Edition</div>
    <div class="card-sub" data-lang-key="price_income">Secret Skin (+3 KSPT/h)</div>
    <button id="skin-kostia" onclick="applySkin('kostia')" data-lang-key="locked_promo">LOCKED (Use Promo)</button>
  </div>

  <div class="card" id="metkaSkinCard" style="display:none">
    <img id="skin-img-metka" src="knowdont.png" class="card-img">
    <div class="card-title">KSPT & RED Fingers</div>
    <div class="card-sub" data-lang-key="price_income">Secret Skin (+5 KSPT/h)</div>
    <button id="skin-metka" onclick="applySkin('metka')" data-lang-key="locked_promo">LOCKED (Use Promo)</button>
  </div>

  <div class="card" id="seriSkinCard" style="display:none">
    <img id="skin-img-seri" src="knowdont.png" class="card-img">
    <div class="card-title">KosTiaP Token</div>
    <div class="card-sub" data-lang-key="price_income">Secret Skin + Animation (+5 KSPT/h)</div>
    <button id="skin-seri" onclick="applySkin('seri')" data-lang-key="locked_promo">LOCKED (Use Promo)</button>
  </div>

  <div class="card" id="artemSkinCard" style="display:none">
    <img id="skin-img-artem" src="knowdont.png" class="card-img">
    <div class="card-title">KSPT: Life Of Shaurma</div>
    <div class="card-sub" data-lang-key="price_income">Secret Skin (+5 KSPT/h)</div>
    <div style="display: flex; gap: 5px; margin-top: 10px;">
      <button id="skin-artem" onclick="applySkin('artem')" data-lang-key="locked_promo" style="flex: 1;">LOCKED (Use Promo)</button>
      <button id="variant-artem" onclick="switchVariant('artem')" style="display:none; background: #444; width: auto; padding: 0 10px;">Variant</button>
    </div>
  </div>

  <div class="card">
  <img id="skin-img-brb" src="dontwhat.png" class="card-img" onerror="this.src='dontwhat.png'">
  <div class="card-title">Big Red Button</div>
  <div id="skin-sub-brb" class="card-sub">Price: 5,000,000 KSPT (+500 KSPT/h)</div>
  <button id="skin-brb" onclick="applySkin('brb')">Buy 5,000,000 KSPT</button>
</div>

  <div class="card">
    <div class="card-title">NUMBER #1!</div>
    <div class="card-sub" id="limitedSkinSub" style="color:#ff9800"></div>
    <button id="skin-priz" onclick="applySkin('priz')" data-lang-key="locked">LOCKED</button>
  </div>

  <button class="back" onclick="openScreen('main')" data-lang-key="back">Back</button>
</div>

<div id="capsuleBreakModal" class="modal">
  <div class="modal-content">
    <img id="capsuleBreakImg" src="cagold.png" alt="cagold">
    <div id="capsuleHint"></div>
    <div id="whiteFade" style="display:none;"></div>
  </div>
</div>

<!-- Noob Box Opening Modal -->
<div id="noobBoxModal" class="capsule-modal">
    <div id="noobBoxHint" style="margin-bottom:20px; font-size:24px; font-weight:bold;">Tap to open! (0/10)</div>
    <img id="noobBoxImg" src="noob.png" class="capsule-center">
</div>

<div id="offlineShop" class="screen">
  <div class="top-bar">
    <img src="kspt.png">
    <span id="balanceOffline"></span>
    <img src="iks.png" class="close-x" onclick="openScreen('main')">
  </div>

  <div class="cardik-header">
    <img id="cardikHeader" src="cardik.png" onerror="this.src='dontwhat.png'">
  </div>
<div class="cardik-tabs">
    <button id="tab-company" class="active" onclick="showCardTab('company')">Company</button>
    <button id="tab-sport" onclick="showCardTab('sport')">Sport</button>
    <button id="tab-games" onclick="showCardTab('games')">Board & Games</button>
    <button id="tab-limited" onclick="showCardTab('limited')">Limited</button>
</div>
  
  <div id="cards-content">
    <!-- Content will be populated by JavaScript -->
  </div>

  <button class="back" onclick="openScreen('main')" data-lang-key="back">Back</button>
</div>

<div id="tech" class="screen">
  <div class="top-bar">
    <img src="kspt.png">
    <span id="balanceTech"></span>
    <img src="iks.png" class="close-x" onclick="openScreen('main')">
  </div>

  <div class="card">
    <div class="card-title" data-lang-key="permanent_x2">Permanent x2</div>
    <div class="card-sub" data-lang-key="price">Price: 5 KSPT</div>
    <button id="btnX2" onclick="buyX2()" data-lang-key="buy">Buy</button>
  </div>

  <div class="card">
    <div class="card-title" data-lang-key="temporary_overdrive">Temporary Overdrive</div>
    <div class="card-sub" data-lang-key="overdrive_desc">x10-x20 Taps for 25+ Seconds</div>
    <div class="card-sub" id="tempBoostTimer" data-lang-key="cooldown_ready">Cooldown: Ready</div>
    <button id="btnTempBoost" onclick="buyTempBoost()" data-lang-key="buy">Buy 15 KSPT</button>
  </div>

  <div class="card">
    <div class="card-title" data-lang-key="upgrade_energy">Upgrade Energy</div>
    <div class="card-sub" data-lang-key="max_energy">Max: 10,000 | +500 Energy</div>
    <div class="card-sub" id="energyInfoText">Current Max: 2500</div>
    <button id="btnEnergyUpgrade" onclick="buyEnergyLimit()" data-lang-key="buy">Buy (+500) 15 KSPT</button>
  </div>
  
  <div class="card">
    <div class="card-title" data-lang-key="energy_regeneration">Energy regeneration multiplier</div>
    <div class="card-sub" id="regenInfo">Current: 1x</div>
    <button id="btnRegen" onclick="buyRegenMult()" data-lang-key="upgrade">Upgrade</button>
  </div>

  <div class="card">
    <div class="card-title" data-lang-key="bet">Bet</div>
    <div class="input-group">
      <input id="betAmount" type="number" placeholder="1‚Äì30" readonly onfocus="showCustomKeyboard(this)">
      <button class="max-btn" onclick="setMaxBet()" data-lang-key="max">MAX</button>
    </div>
    
    <button id="betButton1" onclick="prepareBet(1.5,30)">x1.5 (30%)</button>
    <button id="betButton2" onclick="prepareBet(3,17)">x3 (17%)</button>
    <button id="betButton3" onclick="prepareBet(5,8)">x5 (8%)</button>
    <button id="betButton4" onclick="prepareBet(10,3)">x10 (3%)</button>
    <button id="betButton5" onclick="prepareBet(50,1.1)" style="margin-top:5px; border:1px solid #ff9800; color:#ff9800">x50 (1.1%)</button>
  </div>

  <div id="betConfirm" class="card" style="display:none">
    <div id="betText"></div>
    <button class="confirm" onclick="confirmBet()" data-lang-key="confirm">Confirm</button>
    <button class="cancel" onclick="cancelBet()" data-lang-key="cancel">Cancel</button>
  </div>

  <div class="card promo-box">
    <div class="card-title" data-lang-key="enter_promo">Enter promo code</div>
    <div class="promo-input-group">
      <input id="promoInput" type="text" placeholder="Code...">
      <button class="promo-btn" onclick="checkPromo()" data-lang-key="apply">Apply</button>
    </div>
  </div>

  <button class="back" onclick="openScreen('main')" data-lang-key="back">Back</button>
</div>

<div class="global-nav">
  <div class="nav-item" id="navGames" onclick="openScreen('games')">
    <div class="nav-icon" style="background: url('game.png') center/cover;"></div>
    <span data-lang-key="games">Games</span>
  </div>
  <div class="nav-item active" id="navMain" onclick="openScreen('main')">
    <div class="nav-icon" style="background: url('kspt.png') center/cover;"></div>
    <span data-lang-key="main_menu">Main Menu</span>
  </div>
  <div class="nav-item" id="navMarket" onclick="openScreen('market')">
    <div class="nav-icon" style="background: url('bir.png') center/cover;"></div>
    <span data-lang-key="market">Market</span>
  </div>
</div>

</div> <!-- –∑–∞–∫—Ä—ã—Ç–∏–µ .app -->

<!-- SKINS container (required by game.js) -->
<div id="skins" class="skins-screen" style="display:block; padding:12px; max-width:900px; margin: 10px auto;">
  <!-- existing skin cards will be inserted here by JS -->
</div>

<script src="js/game.js"></script>
<script src="js/games.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function () {
  if (typeof initGames === 'function') {
    initGames();
  }
});
</script>

<script>
  (function(){
    const card = document.getElementById('ekShopCard');
    if (card) {
      card.addEventListener('click', () => {
        // –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è openEKShop –æ–±—ä—è–≤–ª–µ–Ω–∞ –≤ games.js ‚Äî –≤—ã–∑—ã–≤–∞–µ–º –µ—ë
        if (typeof openEKShop === 'function') {
          openEKShop();
        } else {
          // fallback: –µ—Å–ª–∏ –ø–æ–∫–∞ –Ω–µ—Ç games.js –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ–º –≤ iframe —á–µ—Ä–µ–∑ game container
          try {
            const container = document.getElementById('gameFrameContainer');
            const gameContainer = document.getElementById('gameContainer');
            if (container && gameContainer) {
              gameContainer.style.display = 'block';
              gameContainer.classList.add('active');
              container.innerHTML = `<iframe class="game-frame" src="ekshop.html" allow="autoplay"></iframe>`;
            } else {
              // –µ—Å–ª–∏ —Å–æ–≤—Å–µ–º –Ω–∏—á–µ–≥–æ ‚Äî –æ—Ç–∫—Ä–æ–µ–º –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
              window.open('ekshop.html', '_blank');
            }
          } catch(e){ window.open('ekshop.html', '_blank'); }
        }
      });
    }
  })();
</script>

</body>
</html>